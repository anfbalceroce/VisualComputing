<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Marco Teorico # Convolución # 1. Identity: La mascara retorna la misma imagen
\[\begin{bmatrix} 0 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & 0 \end{bmatrix}\] 2. Sharpen: El núcleo de nitidez enfatiza las diferencias en los valores de píxeles adyacentes, lo que hace que la imagen parezca más vívida.
\[\begin{bmatrix} 0 & -1 & 0\\ -1 & 5 & -1\\ 0 & -1 & 0 \end{bmatrix}\] 3."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Convolución"><meta property="og:description" content="Marco Teorico # Convolución # 1. Identity: La mascara retorna la misma imagen
\[\begin{bmatrix} 0 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & 0 \end{bmatrix}\] 2. Sharpen: El núcleo de nitidez enfatiza las diferencias en los valores de píxeles adyacentes, lo que hace que la imagen parezca más vívida.
\[\begin{bmatrix} 0 & -1 & 0\\ -1 & 5 & -1\\ 0 & -1 & 0 \end{bmatrix}\] 3."><meta property="og:type" content="article"><meta property="og:url" content="https://anfbalceroce.github.io/VisualComputing/docs/taller-1/convolucion/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-10-18T22:06:19-05:00"><title>Convolución | Visual Computing 2022-2</title><link rel=manifest href=/VisualComputing/manifest.json><link rel=icon href=/VisualComputing/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing/flexsearch.min.js></script>
<script defer src=/VisualComputing/en.search.min.f444d828fe1f786bd7765b4dfa8c71c0bdc653c9fd2201580cc75a2f6076e30b.js integrity="sha256-9ETYKP4feGvXdltN+oxxwL3GU8n9IgFYDMdaL2B24ws=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing/><span>Visual Computing 2022-2</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Taller 1</span><ul><li><a href=/VisualComputing/docs/taller-1/ilusiones/>Ilusiones</a></li><li><a href=/VisualComputing/docs/taller-1/convolucion/ class=active>Convolución</a></li></ul></li><li class=book-section-flat><span>Taller 2</span><ul><li><a href=/VisualComputing/docs/taller-2/camaras/>Múltiples Cámaras</a></li><li><a href=/VisualComputing/docs/taller-2/W2_Optional/>Ejercicio Opcional</a></li></ul></li><li class=book-section-flat><span>Shaders</span><ul><li><a href=/VisualComputing/docs/shaders/coloring/>Coloring</a></li><li><a href=/VisualComputing/docs/shaders/texturing/>Texturing</a></li><li><a href=/VisualComputing/docs/shaders/ImageProcessing/>Image Processing</a></li><li><a href=/VisualComputing/docs/shaders/ProceduralTexturing/>Procedural Texturing</a></li><li><a href=/VisualComputing/docs/shaders/non-euclidean_geometry/>Non-Euclidean geometry</a></li><li><a href=/VisualComputing/docs/shaders/SpatialCoherence/>Spatial Coherence</a></li><li><a href=/VisualComputing/docs/shaders/photomosaic/>Photomosaic</a></li><li><a href=/VisualComputing/docs/shaders/lighting/>Lighting</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Convolución</strong>
<label for=toc-control><img src=/VisualComputing/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#marco-teorico>Marco Teorico</a><ul><li><a href=#convolución>Convolución</a></li></ul></li><li><a href=#ejercicio>Ejercicio</a></li></ul></nav></aside></header><article class=markdown><h1 id=marco-teorico>Marco Teorico
<a class=anchor href=#marco-teorico>#</a></h1><h2 id=convolución>Convolución
<a class=anchor href=#convoluci%c3%b3n>#</a></h2><p><strong>1. Identity:</strong> La mascara retorna la misma imagen</p><link rel=stylesheet href=/VisualComputing/katex/katex.min.css><script defer src=/VisualComputing/katex/katex.min.js></script>
<script defer src=/VisualComputing/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>
\[\begin{bmatrix}
0 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 0
\end{bmatrix}\]</span><p><strong>2. Sharpen:</strong> El núcleo de nitidez enfatiza las diferencias en los valores de píxeles adyacentes, lo que hace que la imagen parezca más vívida.</p><span>\[\begin{bmatrix}
0 & -1 & 0\\
-1 & 5 & -1\\
0 & -1 & 0
\end{bmatrix}\]</span><p><strong>3. Emboss:</strong> Es una técnica de gráficos por computadora en la que cada píxel de una imagen se reemplaza por un resaltado o una sombra, según los límites claros/oscuros de la imagen original. Las áreas de bajo contraste se reemplazan por un fondo gris</p><span>\[\begin{bmatrix}
-2 & -1 & 0\\
-1 & 2 & 1\\
0 & 1 & 2
\end{bmatrix}\]</span><p><strong>4. Outline:</strong></p><span>\[\begin{bmatrix}
-1 & -1 & -1\\
-1 & 9 & -1\\
-1 & 1 & -1
\end{bmatrix}\]</span><p><strong>5. Gaussian-blur:</strong> es el resultado de desenfocar una imagen por una función gaussiana (llamada así por el matemático y científico Carl Friedrich Gauss).</p><span>\[\begin{bmatrix}
1 & 2 & 1\\
2 & 4 & 1\\
1 & 2 & 1
\end{bmatrix}\]</span><blockquote><p>El operador Sobel es utilizado en procesamiento de imágenes, especialmente en algoritmos de detección de bordes. Técnicamente es un operador diferencial discreto que calcula una aproximación al gradiente de la función de intensidad de una imagen. Para cada punto de la imagen a procesar, el resultado del operador Sobel es tanto el vector gradiente correspondiente como la norma de este vector.</p></blockquote><p><strong>6. Left-sobel:</strong></p><span>\[\begin{bmatrix}
1 & 0 & -1\\
2 & 1 & -2\\
1 & 0 & -1
\end{bmatrix}\]</span><p><strong>7. Right-sobel:</strong></p><span>\[\begin{bmatrix}
-1 & 0 & 1\\
-2 & 1 & 2\\
-1 & 0 & 1
\end{bmatrix}\]</span><p><strong>8. Top-sobel:</strong></p><span>\[\begin{bmatrix}
1 & 2 & 1\\
0 & 1 & 0\\
-1 & -2 & -1
\end{bmatrix}\]</span><p><strong>9. Botton-sobel:</strong></p><span>\[\begin{bmatrix}
-1 & -2 & -1\\
0 & 1 & 0\\
1 & 2 & 1
\end{bmatrix}\]</span><h1 id=ejercicio>Ejercicio
<a class=anchor href=#ejercicio>#</a></h1><details><summary>Ejecuciòn</summary><div class=markdown-inner><iframe src=/VisualComputing/kernels.html style=border:none;width:750px;height:500px></iframe></div></details><details><summary>Còdigo</summary><div class=markdown-inner><h1 id=lightness>Lightness
<a class=anchor href=#lightness>#</a></h1><p>Se utilizaron las siguientes ecuaciones para calcular la constante por la cual se multiplicó el calor de cada pixel.</p><p><strong>HSI</strong></p><span>\(L = \frac{1}{3}\times(cR + cG + cB) \to c = \frac{3L}{(R + G + B)}\)</span><p><strong>HSV</strong></p><span>\(L = \max(cR, cG, cB) \to c = \frac{L}{\max(R, G, B)}\)</span><p><strong>HSL</strong></p><span>\(L = \frac{1}{2}\times(\max(cR, cG, cB) + \min(cR, cG, cB)) \to c = \frac{2L}{\max(R, G, B) + \min(R, G, B)}\)</span><p><strong>Luma (601)</strong></p><span>\(L = 0.2989cR + 0.5870cG + 0.1140cB \to c = \frac{L}{0.2989R + 0.5870G + 0.1140B}\)</span><h1 id=código>Código
<a class=anchor href=#c%c3%b3digo>#</a></h1><details><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>hidden</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;uploaded-image&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span> /&gt; <span style=color:#75715e>&lt;!--imagen subida, de ella se obtiene la representación binaria que luego es usada por el canvas para obtener la representación en RGBA --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>canvas</span> <span style=color:#a6e22e>hidden</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;canvas-for-rgba&#34;</span>&gt;&lt;/<span style=color:#f92672>canvas</span>&gt; <span style=color:#75715e>&lt;!-- canvas solo para dibujar la imagen subida y obtener la representación en RGBA, por eso puede ser oculta --&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;image-input&#34;</span> <span style=color:#a6e22e>accept</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;image/jpeg, image/png, image/jpg&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Kernel: &lt;<span style=color:#f92672>select</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;kernel-select&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>selected</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;identity&#34;</span>&gt;Identity&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gaussian-blur&#34;</span>&gt;Gaussian Blur&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sharpen&#34;</span>&gt;Sharpen&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;outline&#34;</span>&gt;Outline&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;emboss&#34;</span>&gt;Emboss&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left-sobel&#34;</span>&gt;Left Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right-sobel&#34;</span>&gt;Right Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;top-sobel&#34;</span>&gt;Top Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bottom-sobel&#34;</span>&gt;Bottom Sobel&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>select</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>hidden</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lightness-input&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Lightness&#34;</span>&gt;&lt;/<span style=color:#f92672>input</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>select</span> <span style=color:#a6e22e>hidden</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lightness-definition-select&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>selected</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;HSI&#34;</span>&gt;HSI&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;HSV&#34;</span>&gt;HSV&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;HSL&#34;</span>&gt;HSL&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Luma 601&#34;</span>&gt;Luma 601&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Luma 240&#34;</span>&gt;Luma 240&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Luma 709&#34;</span>&gt;Luma 709&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Luma 2020&#34;</span>&gt;Luma 2020&lt;/<span style=color:#f92672>option</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>select</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>canvas</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;transformed-image-canvas&#34;</span>&gt;&lt;/<span style=color:#f92672>canvas</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- Load d3.js --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://d3js.org/d3.v4.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- Create a div where the graph will take place --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;red-histogram&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;green-histogram&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;blue-histogram&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bound</span>(<span style=color:#a6e22e>color</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>color</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>255</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>255</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>color</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>applyLightness</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>L</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#lightness-input&#39;</span>).<span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>L</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>canvas</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#canvas-for-rgba&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#34;2d&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>drawImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>getImageData</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>).<span style=color:#a6e22e>data</span>;  
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>lightness_data</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R_array</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G_array</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B_array</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>def</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#lightness-definition-select&#39;</span>).<span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>];
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constant</span>(<span style=color:#a6e22e>L</span>, <span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>g</span>, <span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>def</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cr</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>r</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>g</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cb</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>b</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bound</span>(Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>cr</span>))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bound</span>(Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>cg</span>))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bound</span>(Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>cb</span>))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>A</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>a</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>R_array</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>R</span>)   
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>G_array</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>G</span>)   
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>B_array</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>B</span>)    
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>lightness_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>R</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>lightness_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>G</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>lightness_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>lightness_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>A</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#transformed-image-canvas&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#34;2d&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>imageData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#39;2d&#39;</span>).<span style=color:#a6e22e>createImageData</span>(<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageData</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>lightness_data</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>putImageData</span>(<span style=color:#a6e22e>imageData</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>R_array</span>, <span style=color:#e6db74>&#39;red&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>G_array</span>, <span style=color:#e6db74>&#39;green&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>B_array</span>, <span style=color:#e6db74>&#39;blue&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// función de procesamiento de la imagen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>processImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>canvas</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#canvas-for-rgba&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#34;2d&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>drawImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>getImageData</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>).<span style=color:#a6e22e>data</span>; <span style=color:#75715e>// data es un arreglo con los valores RGBA de la imagen (arreglo unidimensional)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>transformed_data</span> <span style=color:#f92672>=</span> [] <span style=color:#75715e>// es el arreglo transformado o procesado
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ker</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernel</span>(document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#kernel-select&#39;</span>).<span style=color:#a6e22e>value</span>) <span style=color:#75715e>// kernel a usar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R_array</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G_array</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B_array</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>4</span>) { <span style=color:#75715e>// se itera de 4, i corresponde al valor R del pixel i-ésimo de la imagen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pos</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nbs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>neighbours</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>pos</span>, <span style=color:#a6e22e>width</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ws</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>weights</span>(<span style=color:#a6e22e>ker</span>, <span style=color:#a6e22e>pos</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sum</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ws</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>partialSum</span>, <span style=color:#a6e22e>a</span>) =&gt; <span style=color:#a6e22e>partialSum</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// en la matriz se debe garantizar que la suma de los pesos no sea cero para que funcione
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>atotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// suma ponderada para cada valor R G B A 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>nbs</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>]] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>atotal</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>nbs</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>ws</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// se obtiene la suma ponderada: error cuando sum es cero ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>btotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>A</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>atotal</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>sum</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>R_array</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>R</span>)   
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>G_array</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>G</span>)   
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>B_array</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>B</span>)           
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// se agregan los nuevos valores al arreglo transformado
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>R</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>G</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>transformed_data</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>A</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// se crea canvas de la imagen transformada para mostrarla en pantalla
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// nota: se necesita usar canvas para poder visualizar la imagen apartir del arreglo de R G B A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>canvas</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#transformed-image-canvas&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#34;2d&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>imageData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>getContext</span>(<span style=color:#e6db74>&#39;2d&#39;</span>).<span style=color:#a6e22e>createImageData</span>(<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageData</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>transformed_data</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>putImageData</span>(<span style=color:#a6e22e>imageData</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>R_array</span>, <span style=color:#e6db74>&#39;red&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>G_array</span>, <span style=color:#e6db74>&#39;green&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>B_array</span>, <span style=color:#e6db74>&#39;blue&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se procesa imagen cuando se sube archivo
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image_input</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#image-input&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image_input</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reader</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FileReader</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>readAsDataURL</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>files</span>[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Image</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uploaded_image</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>result</span>
</span></span><span style=display:flex><span>                document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#uploaded-image&#34;</span>).<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uploaded_image</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>processImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#lightness-input&#39;</span>).<span style=color:#a6e22e>removeAttribute</span>(<span style=color:#e6db74>&#34;hidden&#34;</span>); 
</span></span><span style=display:flex><span>                document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;#lightness-definition-select&#39;</span>).<span style=color:#a6e22e>removeAttribute</span>(<span style=color:#e6db74>&#39;hidden&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se procesa imagen cuando se cambia el valor del select kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>kernel_select</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#kernel-select&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel_select</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Image</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#uploaded-image&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>src</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>processImage</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se procesa imagen cuando se cambia el valor del select kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lightness_input</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#lightness-input&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lightness_input</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Image</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#uploaded-image&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>src</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>applyLightness</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// se procesa imagen cuando se cambia el valor del select kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lightness_definition_select</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#lightness-definition-select&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lightness_definition_select</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>image</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Image</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#uploaded-image&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>src</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>applyLightness</span>(<span style=color:#a6e22e>image</span>, <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// obtener posición del pixel según su índice y los valores weight y height
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>position</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>h</span>) =&gt; { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;top-left-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;top-right-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> ((<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;bottom-left-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>==</span> (<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;bottom-right-corner&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;top-row&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>==</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;right-row&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> ((<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> (<span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;bottom-row&#39;</span>;      
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;left-row&#39;</span>;        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;inner-cell&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// arreglo de índices según posición, que será usado para obtener las posiciones de los pixeles vecinos (neighbours) y 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// las posiciones de los pesos de la matriz del kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>indexes</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>position</span>) =&gt; { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;inner-cell&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;left-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [   <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, 
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;right-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>   ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [ 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-row&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                           ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-right-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [                               
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>   ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-left-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-left-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [   <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, 
</span></span><span style=display:flex><span>                       <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>                           ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>position</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-right-corner&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>   
</span></span><span style=display:flex><span>                           ]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> []
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// arreglo con los índices de los pixeles vecinos
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>neighbours</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>position</span>, <span style=color:#a6e22e>w</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>matrix</span> <span style=color:#f92672>=</span> [<span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>), <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>, 
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>,           <span style=color:#a6e22e>i</span>          , <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>), <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>idx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>indexes</span>(<span style=color:#a6e22e>position</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nbs</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>idx</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>i</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>nbs</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>i</span>])
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>nbs</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// kernels disponibles: cada matriz es una matriz de pesos
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>kernel</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;identity&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;gaussian-blur&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;emboss&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;left-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;right-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// se agregó 1 en la posición central para garantizar que suma de pesos no sea cero
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;top-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;bottom-sobel&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;sharpen&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>kernel</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;outline&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>9</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> []
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// arreglo de pesos que se usarán en la suma ponderada del pixel actual: depende del kernel y de la posición del pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>weights</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>ker</span>, <span style=color:#a6e22e>position</span>) =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>idx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>indexes</span>(<span style=color:#a6e22e>position</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ws</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>idx</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>i</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ws</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>ker</span>[<span style=color:#a6e22e>i</span>])
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ws</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>constant</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>L</span>, <span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>, <span style=color:#a6e22e>definition</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;HSI&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> (<span style=color:#a6e22e>R</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>B</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;HSV&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;HSL&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> (Math.<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>) <span style=color:#f92672>+</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>)))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Luma 601&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> (<span style=color:#ae81ff>0.2989</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.5870</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.1140</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Luma 240&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> (<span style=color:#ae81ff>0.212</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.701</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.087</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Luma 709&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> (<span style=color:#ae81ff>0.2126</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.7152</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.0722</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>definition</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Luma 2020&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>L</span> <span style=color:#f92672>/</span> (<span style=color:#ae81ff>0.2627</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.6780</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.0593</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>B</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>   
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>drawHistogram</span>(<span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>color</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;red&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#FF0000&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;green&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#00FF00&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;blue&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#0000FF&#39;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>domain</span>  <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>margin</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span> },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>460</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>right</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>400</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>bottom</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>scaleLinear</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>domain</span>(<span style=color:#a6e22e>domain</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>range</span>([<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>histogram</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>histogram</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>domain</span>(<span style=color:#a6e22e>x</span>.<span style=color:#a6e22e>domain</span>())
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>thresholds</span>(<span style=color:#a6e22e>x</span>.<span style=color:#a6e22e>ticks</span>(<span style=color:#ae81ff>256</span>)); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>bins</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>histogram</span>(<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>select</span>(<span style=color:#e6db74>`#</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-histogram svg`</span>).<span style=color:#a6e22e>remove</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>svg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>select</span>(<span style=color:#e6db74>`#</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-histogram`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#34;svg&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>right</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;height&#34;</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>bottom</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#34;g&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;transform&#34;</span>, <span style=color:#e6db74>&#34;translate(&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;,&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;)&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>svg</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#34;g&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;transform&#34;</span>, <span style=color:#e6db74>&#34;translate(0,&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;)&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>axisBottom</span>(<span style=color:#a6e22e>x</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>scaleLinear</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>range</span>([<span style=color:#a6e22e>height</span>, <span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>domain</span>([
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>bins</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>d</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>svg</span>.<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#34;g&#34;</span>).<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>axisLeft</span>(<span style=color:#a6e22e>y</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>svg</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>selectAll</span>(<span style=color:#e6db74>&#34;rect&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>data</span>(<span style=color:#a6e22e>bins</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>enter</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#34;rect&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;x&#34;</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;transform&#34;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>d</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;translate(&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>x0</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;,&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>length</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;)&#34;</span>;
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>d</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>x</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>x1</span>) <span style=color:#f92672>-</span> <span style=color:#a6e22e>x</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>x0</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#34;height&#34;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>d</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>y</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;fill&#34;</span>, <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>color</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div></div></details></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/anfbalceroce/VisualComputing/commit/15d9b3275fe38a845e935b01b7f7298208b309e2 title='Last modified by anfbalceroce | October 19, 2022' target=_blank rel=noopener><img src=/VisualComputing/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 19, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#marco-teorico>Marco Teorico</a><ul><li><a href=#convolución>Convolución</a></li></ul></li><li><a href=#ejercicio>Ejercicio</a></li></ul></nav></div></aside></main></body></html>