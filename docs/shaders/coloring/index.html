<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Exercise # Figure it out the js code of the above sketches. Implement other blending modes. Blending Modes # Esta aplicación aplica diferentes modos de blend a una imagen con un color. La imagen y el color son seleccionados por el usuario.
Primero se renderiza la imagen cargada, y se envía como textura al blend shader. Al blend shader se le envía el color seleccionado por el usuario como un arreglo de JavaScript de cuatro posiciones."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Coloring"><meta property="og:description" content="Exercise # Figure it out the js code of the above sketches. Implement other blending modes. Blending Modes # Esta aplicación aplica diferentes modos de blend a una imagen con un color. La imagen y el color son seleccionados por el usuario.
Primero se renderiza la imagen cargada, y se envía como textura al blend shader. Al blend shader se le envía el color seleccionado por el usuario como un arreglo de JavaScript de cuatro posiciones."><meta property="og:type" content="article"><meta property="og:url" content="https://anfbalceroce.github.io/VisualComputing/docs/shaders/coloring/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-11-27T21:35:01-05:00"><title>Coloring | Visual Computing 2022-2</title><link rel=manifest href=/VisualComputing/manifest.json><link rel=icon href=/VisualComputing/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing/flexsearch.min.js></script>
<script defer src=/VisualComputing/en.search.min.fd4ff6d932f724148e7f7a4ce6bab0986111bc76f2455480e5aca22ec0a3944c.js integrity="sha256-/U/22TL3JBSOf3pM5rqwmGERvHbyRVSA5ayiLsCjlEw=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing/><span>Visual Computing 2022-2</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Taller 1</span><ul><li><a href=/VisualComputing/docs/taller-1/ilusiones/>Ilusiones</a></li><li><a href=/VisualComputing/docs/taller-1/convolucion/>Convolución</a></li></ul></li><li class=book-section-flat><span>Taller 2</span><ul><li><a href=/VisualComputing/docs/taller-2/camaras/>Múltiples Cámaras</a></li><li><a href=/VisualComputing/docs/taller-2/W2_Optional/>Ejercicio Opcional</a></li></ul></li><li class=book-section-flat><span>Shaders</span><ul><li><a href=/VisualComputing/docs/shaders/coloring/ class=active>Coloring</a></li><li><a href=/VisualComputing/docs/shaders/texturing/>Texturing</a></li><li><a href=/VisualComputing/docs/shaders/ImageProcessing/>Image Processing</a></li><li><a href=/VisualComputing/docs/shaders/ProceduralTexturing/>Procedural Texturing</a></li><li><a href=/VisualComputing/docs/shaders/non-euclidean_geometry/>Non-Euclidean geometry</a></li><li><a href=/VisualComputing/docs/shaders/SpatialCoherence/>Spatial Coherence</a></li><li><a href=/VisualComputing/docs/shaders/photomosaic/>Photomosaic</a></li><li><a href=/VisualComputing/docs/shaders/lighting/>Lighting</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Coloring</strong>
<label for=toc-control><img src=/VisualComputing/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#exercise>Exercise</a></li><li><a href=#blending-modes>Blending Modes</a><ul><li><a href=#controles>Controles</a></li></ul></li><li><a href=#código>Código</a></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=exercise>Exercise
<a class=anchor href=#exercise>#</a></h2><ol><li>Figure it out the js code of the above sketches.</li><li>Implement other blending modes.</li></ol><h2 id=blending-modes>Blending Modes
<a class=anchor href=#blending-modes>#</a></h2><p>Esta aplicación aplica diferentes modos de blend a una imagen con un color. La imagen y el color son seleccionados por el usuario.</p><p>Primero se renderiza la imagen cargada, y se envía como textura al blend shader. Al blend shader se le envía el color seleccionado por el usuario como un arreglo de JavaScript de cuatro posiciones. Cada entrada se divide en 255 para representar un color RGBA normalizado [0..1].</p><p>El blend shader toma el color de cada texel que recibe en la textura (imagen cargada y recibida) y hace el cálculo del blend con el color (vec4) recibido, utilizando la fórmula según corresponda.</p><p>El resultado de la operación de blend es un color que para el pixel de la textura de salida, la cual se renderiza sobre el cuadrado de la parte inferior.</p><p>Esa textura renderizada en la parte inferior es la misma imagen cargada al inicio pero sus colores son el resultado de la operación de blend correspondiente texel a texel con el color seleccionado por el usuario.</p><p>Los blending modes implementados son: multiply, add (linear dodge), screen, overlay, darkest, lightest, color burn, linear burn, difference, divide, exclusion, color dodge, hard light, vivid light, linear light, pin light t cuatro versiones de soft light: photoshop, pegtop, ilussions.hu y w3c.</p><p>Las fórmulas fueron tomadas de <a href=https://en.wikipedia.org/wiki/Blend_modes>Blend Modes (Wikipedia)</a> y <a href=http://www.deepskycolors.com/archivo/2010/04/21/formulas-for-Photoshop-blending-modes.html>Formulas for Photoshop blending modes (RBA&rsquo;s Astrophotography)</a></p><p>Otras referencias utilizadas: <a href=https://stackoverflow.com/questions/67576655/why-my-texture-coordinates-are-inverted-each-time-i-call-my-glsl-shader-in-p5js>Why my texture coordinates are inverted each time I call my GLSL shader in P5.js (Stack Overflow)</a></p><h3 id=controles>Controles
<a class=anchor href=#controles>#</a></h3><ul><li><strong>Botón Choose File</strong>: para cargar una imagen o video</li><li><strong>Checkbox Default Video</strong>: marcar para usar el video por defecto, desmarcar para usar la imagen por defecto</li><li><strong>Slider</strong>: controla el brillo</li><li><strong>Select</strong>: selecciona el blending mode que desea utilizar</li><li><strong>Color Picker</strong>: selecciona el color que se usará en la operación de blend seleccionada para cada texel de la imagen (o video) cargada</li></ul><iframe id=blend style=width:950px;height:900px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
             <script src=https://cdn.jsdelivr.net/gh/VisualComputing/p5.treegl/p5.treegl.js></script> 
            
            
            
            
            <script src=/VisualComputing/sketches/shaders/Blending/blend.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h2 id=código>Código
<a class=anchor href=#c%c3%b3digo>#</a></h2><details><summary>Sketch Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>blendShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colorB</span>; <span style=color:#75715e>// picked by user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span>; <span style=color:#75715e>// vec4 vector sent to shader
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tex</span>; <span style=color:#75715e>// shader output texture
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpickerB</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>bslider</span>; <span style=color:#75715e>// brightness slider
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>bmselect</span>; <span style=color:#75715e>// blending mode select
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>brightness</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mode</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>; <span style=color:#75715e>// shader input texture
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>input</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video_on</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>blendShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/fragments/blend.frag&#39;</span>, { <span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>NONE</span>, <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span> });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>900</span>, <span style=color:#ae81ff>850</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>170</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#ae81ff>800</span>, <span style=color:#ae81ff>800</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpickerB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>colorB</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpickerB</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>490</span>, <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0.05</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>490</span>, <span style=color:#ae81ff>120</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#39;width&#39;</span>, <span style=color:#e6db74>&#39;80px&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>490</span>, <span style=color:#ae81ff>160</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;MULTIPLY&#39;</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;ADD (LINEAR DODGE)&#39;</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;SCREEN&#39;</span>, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;OVERLAY&#39;</span>, <span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;DARKEST&#39;</span>, <span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;LIGHTEST&#39;</span>, <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;COLOR BURN&#39;</span>, <span style=color:#ae81ff>6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;LINEAR BURN&#39;</span>, <span style=color:#ae81ff>7</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;DIFFERENCE&#39;</span>, <span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;DIVIDE&#39;</span>, <span style=color:#ae81ff>9</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;EXCLUSION&#39;</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;COLOR DODGE&#39;</span>, <span style=color:#ae81ff>11</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;HARD LIGHT&#39;</span>, <span style=color:#ae81ff>12</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;VIVID LIGHT&#39;</span>, <span style=color:#ae81ff>13</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;LINEAR LIGHT&#39;</span>, <span style=color:#ae81ff>14</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;PIN LIGHT&#39;</span>, <span style=color:#ae81ff>15</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;SOFT LIGHT 1&#39;</span>, <span style=color:#ae81ff>16</span>); <span style=color:#75715e>// photoshop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;SOFT LIGHT 2&#39;</span>, <span style=color:#ae81ff>17</span>); <span style=color:#75715e>// pegtop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;SOFT LIGHT 3&#39;</span>, <span style=color:#ae81ff>18</span>); <span style=color:#75715e>// ilussions.hu
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;SOFT LIGHT 4&#39;</span>, <span style=color:#ae81ff>19</span>); <span style=color:#75715e>// w3C
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#39;MULTIPLY&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/resources/image.jpg&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video_on</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#39;default video&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video_on</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>video_on</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVideo</span>([<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/resources/video0.mp4&#39;</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/resources/image.jpg&#39;</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();     
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pause</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>blendShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texture&#39;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpickerB</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>450</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>400</span>, <span style=color:#ae81ff>400</span>, <span style=color:#ae81ff>400</span>); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colorB</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#ae81ff>30</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>170</span>, <span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// vec4 vector sent to shader
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> [<span style=color:#a6e22e>colorB</span>.<span style=color:#a6e22e>_getRed</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>, <span style=color:#a6e22e>colorB</span>.<span style=color:#a6e22e>_getGreen</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>, <span style=color:#a6e22e>colorB</span>.<span style=color:#a6e22e>_getBlue</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>, <span style=color:#a6e22e>alpha</span>(<span style=color:#a6e22e>colorB</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>255</span>] <span style=color:#75715e>// normalized
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>brightness</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>value</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bmselect</span>.<span style=color:#a6e22e>value</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tex</span>.<span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>blendShader</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>blendShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texture&#39;</span>, <span style=color:#a6e22e>img</span>); <span style=color:#75715e>// each texel will be color A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>blendShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;colorB&#39;</span>, <span style=color:#a6e22e>B</span>); 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>blendShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;brightness&#39;</span>, <span style=color:#a6e22e>brightness</span>); 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>blendShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;mode&#39;</span>, <span style=color:#a6e22e>mode</span>); 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tex</span>.<span style=color:#a6e22e>square</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>texture</span>(<span style=color:#a6e22e>tex</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>800</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;image&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createImg</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>, <span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;video&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVideo</span>([<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>]);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loop</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><details><summary>Blend Shader</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>precision</span> <span style=color:#66d9ef>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>vec4</span> colorB;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>float</span> brightness; <span style=color:#75715e>// [0, 1]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>int</span> mode;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>sampler2D</span> texture;
</span></span><span style=display:flex><span><span style=color:#66d9ef>varying</span> <span style=color:#66d9ef>vec2</span> texcoords2;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> main() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// https://stackoverflow.com/questions/67576655/why-my-texture-coordinates-are-inverted-each-time-i-call-my-glsl-shader-in-p5js</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec4</span> colorA <span style=color:#f92672>=</span> texture2D(texture, <span style=color:#66d9ef>vec2</span>(texcoords2.x, <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> texcoords2.y)); <span style=color:#75715e>// each texel is color A</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// multiply</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> colorA <span style=color:#f92672>*</span> colorB <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) { <span style=color:#75715e>// add (linear dodge)</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (colorA <span style=color:#f92672>+</span> colorB) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) { <span style=color:#75715e>// screen</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB)) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) { <span style=color:#75715e>// overlay</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>0</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>1</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>3</span>]));
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>) { <span style=color:#75715e>// darkest</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(min(colorA[<span style=color:#ae81ff>0</span>], colorB[<span style=color:#ae81ff>0</span>]), 
</span></span><span style=display:flex><span>                        min(colorA[<span style=color:#ae81ff>1</span>], colorB[<span style=color:#ae81ff>1</span>]), 
</span></span><span style=display:flex><span>                        min(colorA[<span style=color:#ae81ff>2</span>], colorB[<span style=color:#ae81ff>2</span>]), 
</span></span><span style=display:flex><span>                        min(colorA[<span style=color:#ae81ff>3</span>], colorB[<span style=color:#ae81ff>3</span>])) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span>) { <span style=color:#75715e>// lightest</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(max(colorA[<span style=color:#ae81ff>0</span>], colorB[<span style=color:#ae81ff>0</span>]), 
</span></span><span style=display:flex><span>                        max(colorA[<span style=color:#ae81ff>1</span>], colorB[<span style=color:#ae81ff>1</span>]), 
</span></span><span style=display:flex><span>                        max(colorA[<span style=color:#ae81ff>2</span>], colorB[<span style=color:#ae81ff>2</span>]), 
</span></span><span style=display:flex><span>                        max(colorA[<span style=color:#ae81ff>3</span>], colorB[<span style=color:#ae81ff>3</span>])) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span>) { <span style=color:#75715e>// color burn</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> ((<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA) <span style=color:#f92672>/</span> colorB) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span>) { <span style=color:#75715e>// linear burn</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (colorA <span style=color:#f92672>+</span> colorB <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>8</span>) { <span style=color:#75715e>// difference</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (abs(colorA <span style=color:#f92672>-</span> colorB)) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>9</span>) { <span style=color:#75715e>// divide</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (colorA <span style=color:#f92672>/</span> colorB) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>10</span>) { <span style=color:#75715e>// exclusion</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorA <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>*</span> (colorB <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>11</span>) { <span style=color:#75715e>// color dodge</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> (colorA <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB)) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>12</span>) { <span style=color:#75715e>// hard light</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>))) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>))) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>))) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>))) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>];
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>13</span>) { <span style=color:#75715e>// vivid light</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>]));
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>14</span>) { <span style=color:#75715e>// vivid light</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>:</span> (colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>:</span> (colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>:</span> (colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>:</span> (colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>15</span>) { <span style=color:#75715e>// pin light</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> max(colorA[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> min(colorA[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> max(colorA[<span style=color:#ae81ff>1</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> min(colorA[<span style=color:#ae81ff>1</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> max(colorA[<span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> min(colorA[<span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> max(colorA[<span style=color:#ae81ff>3</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>)) <span style=color:#f92672>:</span> min(colorA[<span style=color:#ae81ff>3</span>], <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;    
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>16</span>) { <span style=color:#75715e>// soft light photoshop</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>:</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>+</span> sqrt(colorA[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>:</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>+</span> sqrt(colorA[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>:</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>+</span> sqrt(colorA[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>+</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>:</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>+</span> sqrt(colorA[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>);
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>17</span>) { <span style=color:#75715e>// soft light pegtop</span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> ((<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB)) <span style=color:#f92672>*</span> (colorA <span style=color:#f92672>*</span> colorA) <span style=color:#f92672>+</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB <span style=color:#f92672>*</span> colorA)) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>18</span>) { <span style=color:#75715e>// soft light illusions.hu</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> pow(colorA[<span style=color:#ae81ff>0</span>], pow(<span style=color:#ae81ff>2.</span>, <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>0</span>])));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> pow(colorA[<span style=color:#ae81ff>1</span>], pow(<span style=color:#ae81ff>2.</span>, <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>1</span>])));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> pow(colorA[<span style=color:#ae81ff>2</span>], pow(<span style=color:#ae81ff>2.</span>, <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>2</span>])));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> pow(colorA[<span style=color:#ae81ff>3</span>], pow(<span style=color:#ae81ff>2.</span>, <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0.5</span> <span style=color:#f92672>-</span> colorB[<span style=color:#ae81ff>3</span>])));
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (mode <span style=color:#f92672>==</span> <span style=color:#ae81ff>19</span>) { <span style=color:#75715e>// soft-light w3c</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> gRa <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.25</span>) <span style=color:#f92672>?</span> ((<span style=color:#ae81ff>16.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>12.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>4.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>:</span> sqrt(colorA[<span style=color:#ae81ff>0</span>]); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> gGa <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.25</span>) <span style=color:#f92672>?</span> ((<span style=color:#ae81ff>16.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>12.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>4.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>:</span> sqrt(colorA[<span style=color:#ae81ff>1</span>]); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> gBa <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.25</span>) <span style=color:#f92672>?</span> ((<span style=color:#ae81ff>16.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>12.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>4.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>:</span> sqrt(colorA[<span style=color:#ae81ff>2</span>]); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> gAa <span style=color:#f92672>=</span> (colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.25</span>) <span style=color:#f92672>?</span> ((<span style=color:#ae81ff>16.</span> <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>12.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>4.</span>) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>:</span> sqrt(colorA[<span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> R <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>) <span style=color:#f92672>*</span> (gRa <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> G <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>) <span style=color:#f92672>*</span> (gGa <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> B <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>) <span style=color:#f92672>*</span> (gBa <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> A <span style=color:#f92672>=</span> (colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>?</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>*</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1.</span> <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>:</span> colorA[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>+</span> (<span style=color:#ae81ff>2.</span> <span style=color:#f92672>*</span> colorB[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.</span>) <span style=color:#f92672>*</span> (gAa <span style=color:#f92672>-</span> colorA[<span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(R, G, B, A) <span style=color:#f92672>*</span> brightness;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// http://www.deepskycolors.com/archivo/2010/04/21/formulas-for-Photoshop-blending-modes.html</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/anfbalceroce/VisualComputing/commit/cc5c8882f5737c3f91fc8557fce8b4c9c4e8b097 title='Last modified by anfbalceroce | November 28, 2022' target=_blank rel=noopener><img src=/VisualComputing/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 28, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#exercise>Exercise</a></li><li><a href=#blending-modes>Blending Modes</a><ul><li><a href=#controles>Controles</a></li></ul></li><li><a href=#código>Código</a></li></ul></li></ul></nav></div></aside></main></body></html>