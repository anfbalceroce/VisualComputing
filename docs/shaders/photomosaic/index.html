<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Exercise # Implement a mosaic (or/and ascii art) visual application.
Images Photomosaic # En esta aplicación, se usa el mismo mecanismo de pixelación visto en Spatial Coherence con la diferencia de que cada pixel de baja resolución es mapeado a una imagen. El shader recibe una imagen que contiene todas las imágenees del dataset que compondrán el mosaico. Estas imágenes están ordenadas siguiendo alguna métrica, que en nuestro caso es el luma."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Photomosaic"><meta property="og:description" content="Exercise # Implement a mosaic (or/and ascii art) visual application.
Images Photomosaic # En esta aplicación, se usa el mismo mecanismo de pixelación visto en Spatial Coherence con la diferencia de que cada pixel de baja resolución es mapeado a una imagen. El shader recibe una imagen que contiene todas las imágenees del dataset que compondrán el mosaico. Estas imágenes están ordenadas siguiendo alguna métrica, que en nuestro caso es el luma."><meta property="og:type" content="article"><meta property="og:url" content="https://anfbalceroce.github.io/VisualComputing/docs/shaders/photomosaic/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-11-27T21:35:01-05:00"><title>Photomosaic | Visual Computing 2022-2</title><link rel=manifest href=/VisualComputing/manifest.json><link rel=icon href=/VisualComputing/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing/flexsearch.min.js></script>
<script defer src=/VisualComputing/en.search.min.aac9724df9f8d46cdb7ac881995e54603c0e71789976bd681963da4498f2198c.js integrity="sha256-qslyTfn41GzbesiBmV5UYDwOcXiZdr1oGWPaRJjyGYw=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing/><span>Visual Computing 2022-2</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Taller 1</span><ul><li><a href=/VisualComputing/docs/taller-1/ilusiones/>Ilusiones</a></li><li><a href=/VisualComputing/docs/taller-1/convolucion/>Convolución</a></li></ul></li><li class=book-section-flat><span>Taller 2</span><ul><li><a href=/VisualComputing/docs/taller-2/camaras/>Múltiples Cámaras</a></li><li><a href=/VisualComputing/docs/taller-2/W2_Optional/>Ejercicio Opcional</a></li></ul></li><li class=book-section-flat><span>Shaders</span><ul><li><a href=/VisualComputing/docs/shaders/coloring/>Coloring</a></li><li><a href=/VisualComputing/docs/shaders/texturing/>Texturing</a></li><li><a href=/VisualComputing/docs/shaders/ImageProcessing/>Image Processing</a></li><li><a href=/VisualComputing/docs/shaders/ProceduralTexturing/>Procedural Texturing</a></li><li><a href=/VisualComputing/docs/shaders/non-euclidean_geometry/>Non-Euclidean geometry</a></li><li><a href=/VisualComputing/docs/shaders/SpatialCoherence/>Spatial Coherence</a></li><li><a href=/VisualComputing/docs/shaders/photomosaic/ class=active>Photomosaic</a></li><li><a href=/VisualComputing/docs/shaders/lighting/>Lighting</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Photomosaic</strong>
<label for=toc-control><img src=/VisualComputing/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#exercise>Exercise</a></li><li><a href=#images-photomosaic>Images Photomosaic</a><ul><li><a href=#controles>Controles</a></li></ul></li><li><a href=#dataset>Dataset</a></li><li><a href=#ascii-art-software-only-no-shaders>ASCII Art (Software Only, No Shaders)</a></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=exercise>Exercise
<a class=anchor href=#exercise>#</a></h2><p>Implement a mosaic (or/and ascii art) visual application.</p><h2 id=images-photomosaic>Images Photomosaic
<a class=anchor href=#images-photomosaic>#</a></h2><p>En esta aplicación, se usa el mismo mecanismo de pixelación visto en <strong>Spatial Coherence</strong> con la diferencia de que cada pixel de baja resolución es mapeado a una imagen. El shader recibe una imagen que contiene todas las imágenees del dataset que compondrán el mosaico. Estas imágenes están ordenadas siguiendo alguna métrica, que en nuestro caso es el luma. El shader calcula el color del pixel de baja resolución para texel. A ese color le calcula el luma. Este luma obtenido le indica a la función <strong>texture2D</strong>, qué tanto se debe desplazar horizontalmente hacia la derecha desde el extremo izquierdo para obtener así la coordenada x de la imagen que se quiere dibujar en esa sección (es decir, dónde empieza la imagen en el buffer recibido).</p><h3 id=controles>Controles
<a class=anchor href=#controles>#</a></h3><ul><li><strong>Botón Choose File</strong>: para cargar una imagen o video</li><li><strong>Checkbox Default Video</strong>: marcar para usar el video por defecto, desmarcar para usar la imagen por defecto</li><li><strong>Slider</strong>: define la resolución (por defecto 30, es decir 30 pixeles de baja resolución que en este caso serán imágenes del mosaico por cada lado de la cuadrícula). El mínimo valor es 1 y el máximo 150. Una resolución mayor, implica más pixeles, y por tanto, de menor tamaño cada vez. El tamaño de la cuadrícula es de 600px x 600px por lo que una resolución de 150 implica pixeles de baja resolución de dimensiones 4px x 4px.</li><li><strong>Select</strong>: para decidir si ver la imagen pixelada (keys), la original o el mosaico.</li><li><strong>Input</strong>: ingrese un número entre 1 y 30 para escoger una imagen del dataset. El dataset se muestra en orden abajo de esta aplicación. Observe por ejemplo que panda rojo le corresponde el número 7. Una vez ingresado un número puede usar las flechas de su teclado para cambiar de imagen, siempre que el foco esté sobre el input.</li></ul><iframe id=photomosaic style=width:650px;height:750px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
             <script src=https://cdn.jsdelivr.net/gh/VisualComputing/p5.treegl/p5.treegl.js></script> 
             <script src=https://cdn.jsdelivr.net/gh/objetos/p5.quadrille.js/p5.quadrille.js></script> 
            
            
            
            <script src=/VisualComputing/sketches/shaders/Photomosaic/photomosaic.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h2 id=dataset>Dataset
<a class=anchor href=#dataset>#</a></h2><img src=/VisualComputing/docs/shaders/resources/dataset/1.jpg alt=1 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/2.jpg alt=2 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/3.jpg alt=3 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/4.jpg alt=4 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/5.jpg alt=5 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/6.jpg alt=6 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/7.jpg alt=7 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/8.jpg alt=8 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/9.jpg alt=9 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/10.jpg alt=10 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/11.jpg alt=11 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/12.jpg alt=12 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/13.jpg alt=13 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/14.jpg alt=14 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/15.jpg alt=15 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/16.jpg alt=16 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/17.jpg alt=17 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/18.jpg alt=18 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/19.jpg alt=19 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/20.jpg alt=20 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/21.jpg alt=21 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/22.jpg alt=22 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/23.jpg alt=23 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/24.jpg alt=24 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/25.jpg alt=25 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/26.jpg alt=26 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/27.jpg alt=27 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/28.jpg alt=28 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/29.jpg alt=29 width=150>
<img src=/VisualComputing/docs/shaders/resources/dataset/30.jpg alt=30 width=150>
<details><summary>Sketch Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#e6db74>&#39;use strict&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>photomosaicShader</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>resolution</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>input</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dataset</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>palette</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pg</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>imgcode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video_on</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SAMPLE_RES</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>`/VisualComputing/docs/shaders/resources/dataset/</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>int</span>(<span style=color:#a6e22e>random</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>31</span>))<span style=color:#e6db74>}</span><span style=color:#e6db74>.jpg`</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>30</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dataset</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>`/VisualComputing/docs/shaders/resources/dataset/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>i</span><span style=color:#e6db74>}</span><span style=color:#e6db74>.jpg`</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>photomosaicShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/fragments/photomosaic.frag&#39;</span>, { <span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>NONE</span>, <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span> });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>600</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>photomosaicShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#39;width&#39;</span>, <span style=color:#e6db74>&#39;150px&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;resolution&#39;</span>, <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>value</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;resolution&#39;</span>, <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>value</span>());
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;original&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;keys&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;photomosaic&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#39;photomosaic&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;original&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>resolution</span>.<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;original&#39;</span>, <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;original&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;keys&#39;</span>, <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;keys&#39;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imgcode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createInput</span>(<span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#e6db74>&#39;number&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>palette</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createQuadrille</span>(<span style=color:#a6e22e>dataset</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#a6e22e>SAMPLE_RES</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>SAMPLE_RES</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sample</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video_on</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#39;default video&#39;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video_on</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>video_on</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVideo</span>([<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/resources/video2.mp4&#39;</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loop</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>`/VisualComputing/docs/shaders/resources/dataset/</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>int</span>(<span style=color:#a6e22e>random</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>31</span>))<span style=color:#e6db74>}</span><span style=color:#e6db74>.jpg`</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pause</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;source&#39;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>imgcode</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dataset</span>[(parseInt(<span style=color:#a6e22e>imgcode</span>.<span style=color:#a6e22e>value</span>()) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#a6e22e>dataset</span>.<span style=color:#a6e22e>length</span>];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>600</span>); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;source&#39;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>beginShape</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vertex</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vertex</span>(<span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vertex</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vertex</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>endShape</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sample</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pg</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>SAMPLE_RES</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>width</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#a6e22e>SAMPLE_RES</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>SAMPLE_RES</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>palette</span>.<span style=color:#a6e22e>sort</span>({ <span style=color:#a6e22e>ascending</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#a6e22e>cellLength</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SAMPLE_RES</span> });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>drawQuadrille</span>(<span style=color:#a6e22e>palette</span>, { <span style=color:#a6e22e>graphics</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pg</span>, <span style=color:#a6e22e>cellLength</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>outlineWeight</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>photomosaicShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;palette&#39;</span>, <span style=color:#a6e22e>pg</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;image&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createImg</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>, <span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;video&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVideo</span>([<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loop</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgcode</span>.<span style=color:#a6e22e>value</span>(<span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#75715e>// to avoid getting dataset image instead
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><details><summary>Photomosaic Shader Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl><span style=display:flex><span><span style=color:#66d9ef>precision</span> <span style=color:#66d9ef>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>sampler2D</span> palette;
</span></span><span style=display:flex><span><span style=color:#75715e>// source (image or video) is sent by the sketch</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>sampler2D</span> source;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>bool</span> keys;
</span></span><span style=display:flex><span><span style=color:#75715e>// displays original</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>bool</span> original;
</span></span><span style=display:flex><span><span style=color:#75715e>// target horizontal &amp; vertical resolution</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>float</span> resolution;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>float</span> n;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// interpolated texcoord (same name and type as in vertex shader)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// defined as a (normalized) vec2 in [0..1]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>varying</span> <span style=color:#66d9ef>vec2</span> texcoords2;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> luma(<span style=color:#66d9ef>vec3</span> texel) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0.299</span> <span style=color:#f92672>*</span> texel.r <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.587</span> <span style=color:#f92672>*</span> texel.g <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.114</span> <span style=color:#f92672>*</span> texel.b; <span style=color:#75715e>// min 0, max 255</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> main() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (original) {
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> texture2D(source, texcoords2);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// i. define coord as a texcoords2 remapping in [0.0, resolution] ∈ R</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec2</span> coord <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>*</span> resolution;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ii. remap stepCoord in [0.0, resolution] ∈ Z</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec2</span> stepCoord <span style=color:#f92672>=</span> floor(coord);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec2</span> symbolCoord <span style=color:#f92672>=</span> coord <span style=color:#f92672>-</span> stepCoord;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// iii. remap stepCoord in [0.0, 1.0] ∈ R</span>
</span></span><span style=display:flex><span>    stepCoord <span style=color:#f92672>=</span> stepCoord <span style=color:#f92672>/</span> <span style=color:#66d9ef>vec2</span>(resolution); <span style=color:#75715e>// normalized step coord</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// source texel</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec4</span> key <span style=color:#f92672>=</span> texture2D(source, stepCoord); <span style=color:#75715e>// texel will be the key to look up</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// we calculate key color luma</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> kluma <span style=color:#f92672>=</span> luma(key.rgb);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// palette is an image containing the 30 images but with 1.0 x 1.0 dimensions.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// each key will get an image from the palette: we have the symbol coord (x, y).</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// images are ordered horizontally, so we take x, which indicates the starting coordinate of our key, and divide it by n because we have n images, </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// with this we can start counting from the left-most image to the right</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// to this quotient, we add kluma, which is a value between 0 a 1. It will ensure we are going to use the correct image texel. </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// y coordinate need no special treatment.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// for each texel, we need to paint the correct portion of the image that will represent</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec4</span> paletteTexel <span style=color:#f92672>=</span> texture2D(palette, <span style=color:#66d9ef>vec2</span>(symbolCoord.x <span style=color:#f92672>/</span> n <span style=color:#f92672>+</span> kluma, symbolCoord.y));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> keys <span style=color:#f92672>?</span> key <span style=color:#f92672>:</span> paletteTexel;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h2 id=ascii-art-software-only-no-shaders>ASCII Art (Software Only, No Shaders)
<a class=anchor href=#ascii-art-software-only-no-shaders>#</a></h2><p>Para el de imágenes, se disminuyó el tamaño de los caracteres a 4pt y su interlineado para poder visualizar la imagen en un espacio más pequeño.</p><iframe src=/VisualComputing/sketches/shaders/Photomosaic/videoASCII.html style=border:none;width:1200px;height:1000px></iframe>
<details><summary>Sketch Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>density</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;qwerty12345&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>asciiDiv</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noCanvas</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVideo</span>(
</span></span><span style=display:flex><span>    [<span style=color:#e6db74>&#39;/VisualComputing/docs/shaders/resources/bicho.mp4&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vidLoad</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>size</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>asciiDiv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createDiv</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>vidLoad</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>loop</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>volume</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>(){
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>asciiImage</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){      
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>video</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>avg</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>b</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>density</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>charIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>avg</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#a6e22e>len</span>, <span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>density</span>.<span style=color:#a6e22e>charAt</span>(<span style=color:#a6e22e>charIndex</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#a6e22e>asciiImage</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;&amp;nbsp;&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>asciiImage</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>;
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>asciiImage</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;&lt;br/&gt;&#39;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>asciiDiv</span>.<span style=color:#a6e22e>html</span>(<span style=color:#a6e22e>asciiImage</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><iframe src=/VisualComputing/sketches/shaders/Photomosaic/imageASCII.html style=border:none;width:1200px;height:1000px></iframe>
<details><summary>Sketch Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>density</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;qwerty12345&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>photo</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>(){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>photo</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/VisualComputing/docs/shaders/resources/photo.jpg&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noCanvas</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>photo</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>width</span>,<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>/</span><span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>h</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>/</span><span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){      
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>photo</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>pixelIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>avg</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>b</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>density</span>.<span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>charIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>avg</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#a6e22e>len</span>, <span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>density</span>.<span style=color:#a6e22e>charAt</span>(<span style=color:#a6e22e>charIndex</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#a6e22e>row</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;&amp;nbsp;&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>;
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>createDiv</span>(<span style=color:#a6e22e>row</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/anfbalceroce/VisualComputing/commit/cc5c8882f5737c3f91fc8557fce8b4c9c4e8b097 title='Last modified by anfbalceroce | November 28, 2022' target=_blank rel=noopener><img src=/VisualComputing/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 28, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#exercise>Exercise</a></li><li><a href=#images-photomosaic>Images Photomosaic</a><ul><li><a href=#controles>Controles</a></li></ul></li><li><a href=#dataset>Dataset</a></li><li><a href=#ascii-art-software-only-no-shaders>ASCII Art (Software Only, No Shaders)</a></li></ul></li></ul></nav></div></aside></main></body></html>