<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Workshop 02 - Optional Exercises # Exercise # Implement in software any of the visualizations: primitive rasterization, color shading, z-depth, texture-mapping and/or anti-aliasing (requires a bit of research).
Primitive Rasterization + Color Shading # Press any key to switch between triangles
Implementation Details # Declarations # We declare a variable w that will be each pixel width and height. We declare a variable mid as w/2 to facilitate draawing lines from the center of a pixel."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Ejercicio Opcional"><meta property="og:description" content="Workshop 02 - Optional Exercises # Exercise # Implement in software any of the visualizations: primitive rasterization, color shading, z-depth, texture-mapping and/or anti-aliasing (requires a bit of research).
Primitive Rasterization + Color Shading # Press any key to switch between triangles
Implementation Details # Declarations # We declare a variable w that will be each pixel width and height. We declare a variable mid as w/2 to facilitate draawing lines from the center of a pixel."><meta property="og:type" content="article"><meta property="og:url" content="https://anfbalceroce.github.io/VisualComputing/docs/taller-2/W2_Optional/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-10-19T00:32:52-05:00"><title>Ejercicio Opcional | Visual Computing 2022-2</title><link rel=manifest href=/VisualComputing/manifest.json><link rel=icon href=/VisualComputing/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing/flexsearch.min.js></script>
<script defer src=/VisualComputing/en.search.min.343daeff88c71f43384ec8e53936fbce1534baee2a80a026a86df4804c55d182.js integrity="sha256-ND2u/4jHH0M4TsjlOTb7zhU0uu4qgKAmqG30gExV0YI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing/><span>Visual Computing 2022-2</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Taller 1</span><ul><li><a href=/VisualComputing/docs/taller-1/ilusiones/>Ilusiones</a></li><li><a href=/VisualComputing/docs/taller-1/convolucion/>Convolución</a></li></ul></li><li class=book-section-flat><span>Taller 2</span><ul><li><a href=/VisualComputing/docs/taller-2/camaras/>Múltiples Cámaras</a></li><li><a href=/VisualComputing/docs/taller-2/W2_Optional/ class=active>Ejercicio Opcional</a></li></ul></li><li class=book-section-flat><span>Shaders</span><ul><li><a href=/VisualComputing/docs/shaders/coloring/>Color Shader</a></li><li><a href=/VisualComputing/docs/shaders/texturing/>Texture Mapping Shader</a></li><li><a href=/VisualComputing/docs/shaders/image_processing/>Image processing</a></li><li><a href=/VisualComputing/docs/shaders/procedural_texturing/>Procedural texturing</a></li><li><a href=/VisualComputing/docs/shaders/non-euclidean_geometry/>Non-Euclidean geometry</a></li><li><a href=/VisualComputing/docs/shaders/spatial_coherence/>Spatial coherence</a></li><li><a href=/VisualComputing/docs/shaders/photomosaic/>Photomosaic</a></li><li><a href=/VisualComputing/docs/shaders/lighting/>Lighting</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Ejercicio Opcional</strong>
<label for=toc-control><img src=/VisualComputing/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#workshop-02---optional-exercises>Workshop 02 - Optional Exercises</a><ul><li><ul><li><a href=#exercise>Exercise</a></li></ul></li><li><a href=#primitive-rasterization--color-shading>Primitive Rasterization + Color Shading</a><ul><li><a href=#implementation-details>Implementation Details</a></li></ul></li><li><a href=#z-buffer>Z-buffer</a><ul><li><a href=#implementation-details-1>Implementation Details</a></li></ul></li><li><a href=#texture-mapping>Texture Mapping</a><ul><li><a href=#implementation-details-2>Implementation Details</a></li></ul></li><li><a href=#generalized-texture-mapping>Generalized Texture Mapping</a><ul><li><a href=#implementation-details-3>Implementation Details</a></li><li><a href=#some-examples>Some Examples</a></li></ul></li><li><a href=#anti-aliasing>Anti-aliasing</a><ul><li><a href=#implementation-details-4>Implementation Details</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=workshop-02---optional-exercises>Workshop 02 - Optional Exercises
<a class=anchor href=#workshop-02---optional-exercises>#</a></h1><blockquote><h3 id=exercise>Exercise
<a class=anchor href=#exercise>#</a></h3><p>Implement in software any of the visualizations: primitive rasterization, color shading, z-depth, texture-mapping and/or anti-aliasing (requires a bit of research).</p></blockquote><h2 id=primitive-rasterization--color-shading>Primitive Rasterization + Color Shading
<a class=anchor href=#primitive-rasterization--color-shading>#</a></h2><blockquote><p>Press any key to switch between triangles</p></blockquote><iframe id=rasterization_shading style=width:550px;height:550px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/VisualComputing/sketches/rasterization_shading.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h3 id=implementation-details>Implementation Details
<a class=anchor href=#implementation-details>#</a></h3><h4 id=declarations>Declarations
<a class=anchor href=#declarations>#</a></h4><ul><li>We declare a variable <strong>w</strong> that will be each pixel width and height.</li><li>We declare a variable <strong>mid</strong> as <strong>w/2</strong> to facilitate draawing lines from the center of a pixel.</li><li>We declare the triangle vertexes coordinates as <strong>xA</strong>, <strong>yB</strong>, <strong>xB</strong>, &mldr;</li><li>We declare three color pickers: one per vertex.</li></ul><details><summary>Declarations Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>12.5</span>; <span style=color:#75715e>// to draw lines from center point of each pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>; <span style=color:#75715e>// pixel width and height
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// triangle lines coordinates
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>15</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pixels</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// color pickers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpA</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpB</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpC</span>
</span></span></code></pre></div></div></details><h4 id=setup>Setup
<a class=anchor href=#setup>#</a></h4><ul><li>The canvas of 500 x 500 will be a 20 x 20 pixels grid.</li><li>The color pickers are instantiated with initial colors (R, G, B).</li><li>The grid lines will light green.</li></ul><details><summary>Setup Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>500</span>); <span style=color:#75715e>// 500 / 25 for a 20x20 pixels grid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>R</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpA</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>G</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpB</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>50</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>220</span>); <span style=color:#75715e>// blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>B</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpC</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>100</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LG</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// light green for pixels stroke
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div></div></details><h4 id=draw>Draw
<a class=anchor href=#draw>#</a></h4><ul><li>Colors are updated based on the colors pickers values.</li><li>The grid of 20x20 black pixels is painted. Some of those pixels are then re-painted in colors to display the triangle.</li><li>The triangle vertexes pixels are painted using the current color pickers colors.</li><li>The sides AB, BC, CA are painted.</li><li>To paint a side, we run rasterization Bresenham&rsquo;s line algorithm.</li><li>Bresenham&rsquo;s algorithm returns a list of pixels coordinates. Those pixels are the ones covered by the triangle side.</li><li>We know the vertexes colors for the side that is being painted. From Bresenham&rsquo;s algorithm we now know the side length in terms of pixels.</li><li>We both vertexes colors and side length in pixels we can perform interpolation to do the shading.</li><li>Interolation generated colors are stored in a dictionary <strong>COLORS</strong>, because they will be needed when painting inner pixels.</li><li>An array named <strong>PIXELS</strong> will contain all sides pixels. They will be needed when painting inner pixels.</li><li>The inner pixels painting consists of iterating row by row belonging to the triangle (top to bottom).</li><li>For each row, we get the left most pixel and right most pixel colors.</li><li>With these extremes pixels coordinates, we can calculate the row length.</li><li>Both colors and the row length is then used by the interpolation method to generate the colors of inner pixels.</li><li>Inner pixels are painted.</li><li>Triangle &ldquo;continous&rdquo; lines are painted from the center of each vertex pixel to the center of each vertex pixel.</li></ul><details><summary>Draw Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// colors will be set based on color pickers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpA</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpB</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpC</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>); <span style=color:#75715e>// black background
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#a6e22e>LG</span>); <span style=color:#75715e>// a light green grid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// we draw black squares (pixels) of width and height 25
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>500</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>500</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>  }   
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// we draw triangle vertexes points (A, B, C)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>R</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>G</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>B</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> [] <span style=color:#75715e>// will contain triangle sides pixels coordinates
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>COLORS</span> <span style=color:#f92672>=</span> {} <span style=color:#75715e>// will contain triangle sides pixels colors (key: [r-c] -&gt; value: color)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>  <span style=color:#75715e>// SIDES PAINTING
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// SIDE AB
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>) <span style=color:#75715e>// apply bresenham to get sides pixels coordinates
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>) <span style=color:#75715e>// interpolate using side length and vertexes colors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>] <span style=color:#75715e>// we store colors because we will need them to paint inner pixels (this may have been unnecessary)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// we paint side pixels based on bresenham and interpolation results
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>) <span style=color:#75715e>// we will have duplicates pixels (vertex and maybe others)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// SIDE BC
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>)  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>, <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// SIDE CA
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>, <span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>)  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>B</span>, <span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>) <span style=color:#75715e>// it containes sides pixels coordinates (with some duplicates, but it&#39;s ok with lmp == rmp condition check below in the code)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// INNER PIXELS PAINTING
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// we iterate vertically row by row covering the triangle
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>minY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>); <span style=color:#75715e>// indicates row to start with
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maxY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>); <span style=color:#75715e>// indicates row to end with
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>minY</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>maxY</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>limits</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>p</span>) =&gt; <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>row</span>); <span style=color:#75715e>// sides pixels belonging to this row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// left most pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// lmp and rmp colors will be used in interpolation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lmp</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// if both equal, there&#39;s only one pixel in this row and we don&#39;t need to paint any inner pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rowpixels</span> <span style=color:#f92672>=</span> []; <span style=color:#75715e>// will contain pixels to fill the row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// intermediate pixels count // if consecutive, it&#39;s 0 and for loop below won&#39;t run (no inner pixels to paint)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>lmp</span>) <span style=color:#75715e>// we add first pixel in row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// won&#39;t run if no intermediate pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>ip</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>row</span>}) <span style=color:#75715e>// y is fixed, but x will be incremented from x + 1 to x + ip so that limits are ignored since they are added outside the loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// we add last pixel in row // we add it here to conserve order
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// COLORS dict lookup to get colors and start interpolation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lmc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#75715e>// left most color
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#75715e>// right most color
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>           
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>lmc</span>, <span style=color:#a6e22e>rmc</span>, <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>length</span>) <span style=color:#75715e>// we interpolate using lmc, rmc and row length
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) { 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// we paint based on interpolation (no bresenham needed here)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// &#34;CONTINUOUS&#34; LINES PAINTING
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// we use mid so that lines start and end at the center of each vertex pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h4 id=bresenhams-line-algorithm-implementation>Bresenham&rsquo;s line algorithm implementation
<a class=anchor href=#bresenhams-line-algorithm-implementation>#</a></h4><ul><li>This implementation was translated to JavaScript from an implementation written in Python available at: <a href=https://github.com/encukou/bresenham>encukou Bresenham&rsquo;s line algorithm Python implementation</a></li></ul><details><summary>Bresenham&rsquo;s line algorithm Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>x0</span>, <span style=color:#a6e22e>y0</span>, <span style=color:#a6e22e>x1</span>, <span style=color:#a6e22e>y1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>x1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>y0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xy</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xsign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ysign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dy</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dx</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dy</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>dy</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>D</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xx</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yx</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xy</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yy</span>})
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>D</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>y</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>D</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>D</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>pixels</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h4 id=shading-interpolation-implementation>Shading Interpolation implementation
<a class=anchor href=#shading-interpolation-implementation>#</a></h4><ul><li><p>This function was written based on a rasterization algorithm explainer found in YouTube and available at: <a href="https://www.youtube.com/watch?v=t7Ztio8cwqM">Cédric Girardin (HuCE - cpvrLab) - Rasterizer Algorithm Explanation</a></p></li><li><p>The intuitive idea behind the linear interpolation can be grasped with the help of below image:</p></li></ul><p><img src=../images/interpolation.PNG alt="Shading with linear interpolation"></p><details><summary>Shading Interpolation Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>c0</span>, <span style=color:#a6e22e>c1</span>, <span style=color:#a6e22e>n</span>) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c0</span>.<span style=color:#a6e22e>_getRed</span>() <span style=color:#75715e>// color 0 red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c0</span>.<span style=color:#a6e22e>_getGreen</span>() <span style=color:#75715e>// color 0 green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c0</span>.<span style=color:#a6e22e>_getBlue</span>() <span style=color:#75715e>// color 0 blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_getRed</span>() <span style=color:#75715e>// color 1 red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_getGreen</span>() <span style=color:#75715e>// color 1 green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_getBlue</span>() <span style=color:#75715e>// color 1 blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>n</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// denominator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>n0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>i</span>; <span style=color:#75715e>// color 0 numerator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>n1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span>; <span style=color:#75715e>// color 1 numerator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>n0</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>d</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>n1</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>d</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scaled_r0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>r0</span>; <span style=color:#75715e>// scaled red 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_g0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>g0</span>; <span style=color:#75715e>// scaled green 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_b0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>b0</span>; <span style=color:#75715e>// scaled blue 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scaled_r1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>r1</span>; <span style=color:#75715e>// scaled red 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_g1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>g1</span>; <span style=color:#75715e>// scaled green 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_b1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>b1</span>; <span style=color:#75715e>// scaled blue 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>interpolated_r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scaled_r0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>scaled_r1</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>interpolated_g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scaled_g0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>scaled_g1</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>interpolated_b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scaled_b0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>scaled_b1</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>interpolated_r</span>, <span style=color:#a6e22e>interpolated_g</span>, <span style=color:#a6e22e>interpolated_b</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>colors</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h4 id=auxiliary-functions>Auxiliary Functions
<a class=anchor href=#auxiliary-functions>#</a></h4><ul><li>Any time a key is pressed, vertex coordinates are updated based on a random integer method with max being inclusive.</li></ul><details><summary>Auxiliary Functions Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// new vertex coordinates are generated when pressing a key
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// auxiliary function to get random integers (inclusive)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#a6e22e>min</span>, <span style=color:#a6e22e>max</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>min</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>ceil</span>(<span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>max</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>); <span style=color:#75715e>// inclusive
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div></div></details><h2 id=z-buffer>Z-buffer
<a class=anchor href=#z-buffer>#</a></h2><blockquote><p>Press any key to visualize z-buffer.</p></blockquote><blockquote><p>Press any key again to deactivate it.</p></blockquote><iframe id=zbuffer style=width:550px;height:550px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
             <script src=https://cdn.jsdelivr.net/gh/freshfork/p5.EasyCam@1.2.1/p5.easycam.js></script> 
            
            
            
            
            <script src=/VisualComputing/sketches/zbuffer.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h3 id=implementation-details-1>Implementation Details
<a class=anchor href=#implementation-details-1>#</a></h3><h4 id=declarations-1>Declarations
<a class=anchor href=#declarations-1>#</a></h4><ul><li><strong>P</strong> is the position of the camara in the 3D space.</li><li><strong>positions</strong> contains the position of each box at any moment.</li><li><strong>zbuffer</strong> contains distance from each box to the camera position <strong>P</strong> at any moment.</li><li><strong>colors</strong> contains the interpolated gray scale color of each box at any moment <strong>P</strong>.</li></ul><details><summary>Declarations Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>angle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// angle for boxes rotation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>positions</span> <span style=color:#f92672>=</span> [ <span style=color:#75715e>// will contain boxes 3D positions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>zbuffer</span> <span style=color:#f92672>=</span> [] <span style=color:#75715e>// will contain distance between camera and each box.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> []; <span style=color:#75715e>// will contain colors of boxes at any moment.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>active</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// flag to indicate z-buffer is being visualized
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>easycam</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>P</span>; <span style=color:#75715e>// camera position
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// time counter just to play with ligths transitions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// lights colors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span></code></pre></div></div></details><h4 id=setup-1>Setup
<a class=anchor href=#setup-1>#</a></h4><ul><li>The camara starting position is (0, 0, 600).</li><li>50 boxes are placed throughout the space at random positions.</li><li>Boxes positions are stored in array <strong>positions</strong></li></ul><details><summary>Setup Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>500</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>easycam</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createEasyCam</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// camera distance from center (0, 0, 0) will be 600.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// when applying the quaternion (1, 0, 0, 0) with qpq&#39; operation, camera will be in (0, 0, 600) position as expected.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>state</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>distance</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>600</span>,           
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>],       
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rotation</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], <span style=color:#75715e>// p=(0, 0, 600) =&gt; qpq&#39;=(0, 0, 600)  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>setState</span>(<span style=color:#a6e22e>state</span>, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 50 boxes are placed throughout the space with random positions.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>250</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>250</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>z</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>250</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>positions</span>.<span style=color:#a6e22e>push</span>([<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>z</span>]); <span style=color:#75715e>// positions are stored.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h4 id=draw-1>Draw
<a class=anchor href=#draw-1>#</a></h4><ul><li>Z-buffer visualization drawing consists of:</li><li>Getting the camera position P.</li><li>Updating the <strong>zbuffer</strong> by calculating distances from boxes to P.</li><li>Updating the <strong>colors</strong> array by interpolating using some given thresholds.</li><li>With <strong>colors</strong> array being updated, each box is painted.</li></ul><details><summary>Draw Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>P</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>easycam</span>.<span style=color:#a6e22e>getPosition</span>(); <span style=color:#75715e>// P is the camera position.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>updateZBuffer</span>(); <span style=color:#75715e>// update Z-buffer function stores the distance between camera and each point in the zbuffer array.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>updateColors</span>(); <span style=color:#75715e>// based on the zbuffer values, each box will have a color calculated via interpolation.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>active</span>) { <span style=color:#75715e>// if z-buffer is not being visualized, lights colores are updated every so often.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>locX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mouseX</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>locY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mouseY</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>t</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>300</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>R1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>G1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>B1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>); 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>t</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>151</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>R2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>G2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>B2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>); 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ambientLight</span>(<span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>60</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 3 lights are being used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pointLight</span>(<span style=color:#a6e22e>R1</span>, <span style=color:#a6e22e>G1</span>, <span style=color:#a6e22e>B1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>); <span style=color:#75715e>// center light
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pointLight</span>(<span style=color:#a6e22e>R2</span>, <span style=color:#a6e22e>G2</span>, <span style=color:#a6e22e>B2</span>, <span style=color:#a6e22e>locX</span>, <span style=color:#a6e22e>locY</span>, <span style=color:#ae81ff>250</span>); <span style=color:#75715e>// mouse driven light
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pointLight</span>(<span style=color:#a6e22e>B2</span>, <span style=color:#a6e22e>R1</span>, <span style=color:#a6e22e>G2</span>, <span style=color:#a6e22e>P</span>[<span style=color:#ae81ff>2</span>], <span style=color:#a6e22e>P</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>P</span>[<span style=color:#ae81ff>0</span>]); <span style=color:#75715e>// camera driven light
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>ambientMaterial</span>(<span style=color:#ae81ff>250</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>positions</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>translate</span>(<span style=color:#a6e22e>positions</span>[<span style=color:#a6e22e>i</span>][<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>positions</span>[<span style=color:#a6e22e>i</span>][<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>positions</span>[<span style=color:#a6e22e>i</span>][<span style=color:#ae81ff>2</span>]); <span style=color:#75715e>// with push and pop, translation and rotation of each box is independent of each other.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>rotateX</span>(<span style=color:#a6e22e>angle</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rotateY</span>(<span style=color:#a6e22e>angle</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.4</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>active</span>) <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]); <span style=color:#75715e>// if zbuffer is being visualized, boxes are painted based on interpolated colors in colors array
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>box</span>(<span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>angle</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.01</span>; <span style=color:#75715e>// boxes rotation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>t</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h4 id=update-functions-interpolation-and-distance-calculation>Update Functions, Interpolation and Distance Calculation.
<a class=anchor href=#update-functions-interpolation-and-distance-calculation>#</a></h4><ul><li>Interpolation uses 250 and 750 thresholds. These are needed so that colors changed when zooming in and zooming out.</li></ul><details><summary>Draw Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>updateZBuffer</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>zbuffer</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>positions</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>zbuffer</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>distance</span>(<span style=color:#a6e22e>P</span>, <span style=color:#a6e22e>positions</span>[<span style=color:#a6e22e>i</span>])); <span style=color:#75715e>// distance between box and camera position P
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>updateColors</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// thresholds (250, 750) are used so that boxes color change when zooming in and zooming out.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>positions</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>interpolate</span>(<span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>750</span>, <span style=color:#a6e22e>zbuffer</span>[<span style=color:#a6e22e>i</span>])); <span style=color:#75715e>// interpolation returns a gray scale color.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// linear interpolation with gray scale colors.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>low</span>, <span style=color:#a6e22e>high</span>, <span style=color:#a6e22e>mid</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>low</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y0</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>255</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>high</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mid</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y0</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x0</span>) <span style=color:#f92672>*</span> ((<span style=color:#a6e22e>y1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>y0</span>) <span style=color:#f92672>/</span> (<span style=color:#a6e22e>x1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x0</span>));
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h4 id=auxiliary-functions-1>Auxiliary Functions
<a class=anchor href=#auxiliary-functions-1>#</a></h4><ul><li><strong>active</strong> flag is to toggle z-buffer visualiztion.</li></ul><details><summary>Auxiliary Functions Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// auxiliary functions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>active</span>) <span style=color:#a6e22e>active</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>active</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#a6e22e>min</span>, <span style=color:#a6e22e>max</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>min</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>ceil</span>(<span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>max</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h2 id=texture-mapping>Texture Mapping
<a class=anchor href=#texture-mapping>#</a></h2><blockquote><p>Press ENTER to toggle full texture.</p></blockquote><blockquote><p>Press any key (different from ENTER ) to update triangle vertexes.</p></blockquote><iframe id=dedicated_texture_mapping style=width:1100px;height:550px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/VisualComputing/sketches/dedicated_texture_mapping.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h3 id=implementation-details-2>Implementation Details
<a class=anchor href=#implementation-details-2>#</a></h3><ul><li>The texture mapping consisted on iterating over each pixel of the real image. For each of these coordinates of the form <strong>(r, c)</strong> we applied the mapping:</li></ul><link rel=stylesheet href=/VisualComputing/katex/katex.min.css><script defer src=/VisualComputing/katex/katex.min.js></script>
<script defer src=/VisualComputing/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>
\[\left(r,\ c\right)\rightarrow(\left\lfloor\frac{r}{w}\right\rfloor,\ \left\lfloor\frac{c}{w}\right\rfloor\ )\ \]</span><ul><li><p>In this implementation <strong>w</strong> is 16.</p></li><li><p>This mapping splits all pixels in groups of <strong>16 x 16 = 256</strong> pixels each one. All colors of those pixels are averaged to get the texture pixel color.</p></li><li><p>Important details were already presented in the first exercise. Please refer to code comments for more information.</p></li></ul><details><summary>Full Implementation Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>; <span style=color:#75715e>// pixels width and height is 16
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>; <span style=color:#75715e>// pixel mid length to draw lines
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// triangle vertexes coordinates
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>15</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>full</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// flag to toggle full texture view
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>512</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#ae81ff>512</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>LG</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// line green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#39;/VisualComputing/docs/contenido/images/image.png&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>512</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>); <span style=color:#75715e>// image is scaled up so we are treating it as a 512 px x 512 px image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// pixels grid is painted
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#a6e22e>LG</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>512</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>512</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>    }   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>COLORS</span> <span style=color:#f92672>=</span> {} <span style=color:#75715e>// colors dictionary when key is pixel coordinate
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>512</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i_</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>512</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>i_</span>, <span style=color:#a6e22e>j</span>); <span style=color:#75715e>// color is obtained from real image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>i</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>16</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>j</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>16</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>; <span style=color:#75715e>// key generation is the mapping done from real image to texture image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>].<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>color</span>); <span style=color:#75715e>// each value of dictionary is an array of 16 x 16 = 256 colors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// for each array of 256 colors, we average to get pixel color.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>COLORS</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>c</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>R</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>G</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>B</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>=</span> [Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>R</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>16</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>), Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>G</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>16</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>), Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>B</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>16</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)] <span style=color:#75715e>// COLORS values are no longer arrays but a single averaged color.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// if full texture view, we paint all pixels.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>full</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>COLORS</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>])
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>key</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;-&#39;</span>)[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>key</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;-&#39;</span>)[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// we paint triangle sides by using Bresenham&#39;s algorithm.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// we don&#39;t need interpolation because we already have the colors.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>)  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>)  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>, <span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>)  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// iterate vertically row by row covering the triangle
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>minY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maxY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>minY</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>maxY</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>limits</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>p</span>) =&gt; <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>row</span>); <span style=color:#75715e>// sides pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lmp</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// if both equal, just one pixel in this row and no painting is needed since no inner pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rowpixels</span> <span style=color:#f92672>=</span> []; <span style=color:#75715e>// will contain pixels to fill the row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// intermediate pixels // if consecutive, 0 and for loop below won&#39;t run
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>lmp</span>) <span style=color:#75715e>// we add first pixel in row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// won&#39;t run if no intermediate pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>ip</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>row</span>}) <span style=color:#75715e>// y is fixed, but x will be incremented from x + 1 to x + ip so that limits are ignored since they are added outside the loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// we add last pixel in row // we add it here to conserve order
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// we paint row pixels using COLORS dictionary
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>        }   
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// we paint lines on both texture and real images
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>512</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);      
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Bresenham&#39;s line algorithm implementation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>x0</span>, <span style=color:#a6e22e>y0</span>, <span style=color:#a6e22e>x1</span>, <span style=color:#a6e22e>y1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>x1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>y0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xy</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xsign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ysign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dy</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dx</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dy</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>dy</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>D</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xx</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yx</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xy</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yy</span>})
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>D</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>y</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>D</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>D</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>pixels</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Auxiliaty Functions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ENTER</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>full</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>full</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ENTER</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>full</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>full</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#a6e22e>min</span>, <span style=color:#a6e22e>max</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>min</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>ceil</span>(<span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>max</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h2 id=generalized-texture-mapping>Generalized Texture Mapping
<a class=anchor href=#generalized-texture-mapping>#</a></h2><blockquote><p>Press ENTER to toggle full texture.</p></blockquote><blockquote><p>Press any key (different from ENTER ) to update triangle vertexes.</p></blockquote><iframe id=generalized_texture_mapping style=width:2000px;height:1000px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/VisualComputing/sketches/generalized_texture_mapping.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h3 id=implementation-details-3>Implementation Details
<a class=anchor href=#implementation-details-3>#</a></h3><ul><li><p>Following is a generalized implementation of texture mapping that allows the user to upload an image.</p></li><li><p>Implementation is the same as the one we presented, but it now uses a file handler and construct a canvas and a pixels grid based on the uploaded image dimensions.</p></li><li><p>Mapping keeps being done with <strong>w = 16</strong> to get groups of 256 pixels.</p></li><li><p>For a better experience, please consider to upload small to medium size images.</p></li></ul><details><summary>Full Implementation Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>; <span style=color:#75715e>// pixel width and height: split is in groups of 256 pixels.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>input</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>15</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>full</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>LG</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createFileInput</span>(<span style=color:#a6e22e>handleFile</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>img</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>stroke</span>(<span style=color:#a6e22e>LG</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>            } 
</span></span><span style=display:flex><span>        }   
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>COLORS</span> <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i_</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>i_</span>, <span style=color:#a6e22e>j</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>i</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>j</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>].<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>color</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>COLORS</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>c</span>) =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>R</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>G</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>B</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>=</span> [Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>R</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>), Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>G</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>), Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>B</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>full</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>COLORS</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>COLORS</span>[<span style=color:#a6e22e>key</span>])
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>key</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;-&#39;</span>)[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>key</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;-&#39;</span>)[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>)  
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>)  
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>, <span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>)  
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>c</span>[<span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#75715e>// iterate vertically row by row covering the triangle
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>minY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maxY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>minY</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>maxY</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>limits</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>p</span>) =&gt; <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>row</span>); <span style=color:#75715e>// sides pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lmp</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// if both equal, just one pixel in this row and no inner pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rowpixels</span> <span style=color:#f92672>=</span> []; <span style=color:#75715e>// will contain pixels to fill the row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// intermediate pixels // if consecutive, 0 and for loop below won&#39;t run
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>lmp</span>) <span style=color:#75715e>// we add first pixel in row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// won&#39;t run if no intermediate pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>ip</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>row</span>}) <span style=color:#75715e>// y is fixed, but x will be incremented from x + 1 to x + ip so that limits are ignored since they are added outside the loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// we add last pixel in row // we add it here to conserve order
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>c</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>            }   
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);      
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ENTER</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>full</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>full</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ENTER</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>full</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>full</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>)  <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>w</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#a6e22e>min</span>, <span style=color:#a6e22e>max</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>min</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>ceil</span>(<span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>max</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>x0</span>, <span style=color:#a6e22e>y0</span>, <span style=color:#a6e22e>x1</span>, <span style=color:#a6e22e>y1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>x1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>y0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xy</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xsign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ysign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dy</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dx</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dy</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>dy</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>D</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xx</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yx</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xy</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yy</span>})
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>D</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>y</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>D</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>D</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>pixels</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleFile</span>(<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>print</span>(<span style=color:#a6e22e>file</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;image&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createImg</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>data</span>, <span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div></div></details><h3 id=some-examples>Some Examples
<a class=anchor href=#some-examples>#</a></h3><p><img src=../images/parrots1.jpg alt="Parrots Example 1 Image"></p><p><img src=../images/parrots1result.PNG alt="Parrots Example 1 Result"></p><p><img src=../images/parrots2.jpg alt="Parrots Example 2 Image"></p><p><img src=../images/parrots2result.PNG alt="Parrots Example 2 Result"></p><h2 id=anti-aliasing>Anti-aliasing
<a class=anchor href=#anti-aliasing>#</a></h2><blockquote><p>Press ENTER to toggle anti-aliasing.</p></blockquote><blockquote><p>Press BACKSPACE to toggle triangle lines.</p></blockquote><blockquote><p>Press any other key to randomly update triangle vertexes.</p></blockquote><iframe id=barycentric_antialiasing style=width:700px;height:700px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/VisualComputing/sketches/barycentric_antialiasing.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h3 id=implementation-details-4>Implementation Details
<a class=anchor href=#implementation-details-4>#</a></h3><ul><li><p>Implementation is almost the same as the first exercise we presented. The difference is that it adds an additional layer for anti-aliasing.</p></li><li><p>The anti-aliasing was implemented based on Fabian “ryg” Giesen blog article: &ldquo;The barycentric conspiracy&rdquo; which is available at: <a href=https://fgiesen.wordpress.com/2013/02/06/the-barycentric-conspirac/>The Barycentric Conspiracy by Fabian &ldquo;ryg&rdquo; Giesen</a></p></li><li><p>Summarizing, the anti-aliasing implemented consists in: taking all pixels belonging to the triangle sides (obtained from Bresenham&rsquo;s line algorithm). Subdividing each of these pixels in 4 subpixels. For each of these subpixels, apply the barycentric coordinates method to determine whether the point in the center of each of these subpixels is in the triangle. The test will either return true or false. If it&rsquo;s true, then we use pixel (the pixel to whcih the subpixel belongs) color. If false, we use background color which in this case is black (0). We add the four colors and take its average. We paint all subpixels with this color.</p></li><li><p>The code used to test whether a point is in a triangle (describe by its vertexes A, B, C) was took from Glenn Slayden answer to the following question in Stack Overflow: <a href=https://stackoverflow.com/questions/2049582/how-to-determine-if-a-point-is-in-a-2d-triangle>How to determine if a point is in a 2D triangle? [closed]</a>. Glenn&rsquo;s answer computes the test without needing to know how are the triangle vertexes numbered: clockwise or counterclockwise, which is a requirement of other implementations.</p></li></ul><details><summary>Full Implementation Code</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>w</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>; <span style=color:#75715e>// width and height of pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>15</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pixels</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>antialiasing</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lines</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// color pickers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpA</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpB</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cpC</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>640</span>, <span style=color:#ae81ff>640</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>R</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpA</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>G</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpB</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>50</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>220</span>); <span style=color:#75715e>// blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createColorPicker</span>(<span style=color:#a6e22e>B</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpC</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>100</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LG</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// line green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// colors will be set based on color pickers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpA</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpB</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpC</span>.<span style=color:#a6e22e>color</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stroke</span>(<span style=color:#a6e22e>LG</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>640</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>640</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>  }   
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>R</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>G</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>B</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>COLORS</span> <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>)  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xB</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>)  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>, <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>xC</span>, <span style=color:#a6e22e>yC</span>, <span style=color:#a6e22e>xA</span>, <span style=color:#a6e22e>yA</span>)  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>B</span>, <span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PIXELS</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>pixels</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// iterate vertically row by row covering the triangle
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>minY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maxY</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>yA</span>, <span style=color:#a6e22e>yB</span>, <span style=color:#a6e22e>yC</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>minY</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>maxY</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>limits</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>p</span>) =&gt; <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>row</span>); <span style=color:#75715e>// sides pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>limits</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) =&gt; (<span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>b</span>) <span style=color:#75715e>// right most pixel  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lmp</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// if both equal, no inner pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rowpixels</span> <span style=color:#f92672>=</span> []; <span style=color:#75715e>// will contain pixels to fill the row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// intermediate pixels // if consecutive, 0 and for loop below won&#39;t run
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>lmp</span>) <span style=color:#75715e>// we add first pixel in row
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// won&#39;t run if no intermediate pixels
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>ip</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>row</span>}) <span style=color:#75715e>// y is fixed, but x will be incremented from x + 1 to x + ip so that limits are ignored since they are added outside the loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>rmp</span>) <span style=color:#75715e>// we add last pixel in row // we add it here to conserve order
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// COLORS dict lookup to get colors and start interpolation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lmc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>lmp</span>.<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#75715e>// left most color
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rmc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rmp</span>.<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>] <span style=color:#75715e>// right most color
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>           
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>lmc</span>, <span style=color:#a6e22e>rmc</span>, <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>length</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>rowpixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>rowpixels</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>w</span>);
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ANTI-ALIASING
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>antialiasing</span>) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Vertexes pixels center points
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tA</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tB</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tC</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// SIDES PIXELS ARE DIVIDED IN 4 SUBPIXELS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>PIXELS</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>x</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PIXELS</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>COLORS</span>[<span style=color:#e6db74>`[</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>]`</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>SUBPIXELS</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> },
</span></span><span style=display:flex><span>        { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> },
</span></span><span style=display:flex><span>        { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> },
</span></span><span style=display:flex><span>        { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> }
</span></span><span style=display:flex><span>      ]  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// FOR EACH SUBPIXEL WE DETERMINE IF ITS CENTER IS IN THE TRIANGLE
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// IF YES: WE USE PIXEL COLOR
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// IF NOT: WE USE BLACK COLOR (BACKGROUND COLOR: 0, WE ADD NOTHING TO THE AVERAGE SUM)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// WE AVERAGE COLORS TO PAINT THE WHOLE PIXEL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>SUBPIXELS</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>SP</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>P</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SP</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SP</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span> }; <span style=color:#75715e>// center of sub pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>covered</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>PInTriangle</span>(<span style=color:#a6e22e>P</span>, <span style=color:#a6e22e>tA</span>, <span style=color:#a6e22e>tB</span>, <span style=color:#a6e22e>tC</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>covered</span>) { <span style=color:#75715e>// if not covered we don&#39;t add (add 0 which is like adding black (background color))
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>R</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>_getRed</span>();
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>G</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>_getGreen</span>();
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>B</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>_getBlue</span>();
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>        }    
</span></span><span style=display:flex><span>      })  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>R</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>R</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>G</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>G</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>B</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>B</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>R</span>, <span style=color:#a6e22e>G</span>, <span style=color:#a6e22e>B</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// WE PAINT ALL SUBPIXELS WITH THE SAME AVERAGED COLOR
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>SUBPIXELS</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>SP</span>) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>square</span>(<span style=color:#a6e22e>SP</span>.<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>SP</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>w</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lines</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// we now paint the triangle lines using mid so that line starts and ends in the center of a pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>push</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>strokeWeight</span>(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yB</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>line</span>(<span style=color:#a6e22e>xC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yC</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>xA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>, <span style=color:#a6e22e>yA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>w</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mid</span>);  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// piece of code took from Glenn Slayden answer to the following StackOverflow question: https://stackoverflow.com/questions/2049582/how-to-determine-if-a-point-is-in-a-2d-triangle
</span></span></span><span style=display:flex><span><span style=color:#75715e>// This function applies barycentric coordinates method but doesn&#39;t need to know if vertex are numerated clock or counter-clock wise. 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>PInTriangle</span>(<span style=color:#a6e22e>P</span>, <span style=color:#a6e22e>A</span>, <span style=color:#a6e22e>B</span>, <span style=color:#a6e22e>C</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>s</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>C</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>P</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>C</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>-</span> (<span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>C</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>P</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>C</span>.<span style=color:#a6e22e>x</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>B</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>P</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>-</span> (<span style=color:#a6e22e>B</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>P</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>x</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ((<span style=color:#a6e22e>s</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>!=</span> (<span style=color:#a6e22e>t</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>s</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>C</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>B</span>.<span style=color:#a6e22e>x</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>P</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>B</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>-</span> (<span style=color:#a6e22e>C</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>B</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>P</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>B</span>.<span style=color:#a6e22e>x</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> (<span style=color:#a6e22e>d</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>==</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Bresenham&#39;s line algorithm to draw sides.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bresenham</span>(<span style=color:#a6e22e>x0</span>, <span style=color:#a6e22e>y0</span>, <span style=color:#a6e22e>x1</span>, <span style=color:#a6e22e>y1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>x1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>y0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xy</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>yy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>xsign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>ysign</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>dy</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dx</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>dy</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>dy</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xx</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>xy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ysign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>xsign</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>yy</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>D</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pixels</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>push</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xx</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yx</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>xy</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>yy</span>})
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>D</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>y</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>D</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dx</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>D</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dy</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>pixels</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Interpolation for shading coloring
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>interpolate</span>(<span style=color:#a6e22e>c0</span>, <span style=color:#a6e22e>c1</span>, <span style=color:#a6e22e>n</span>) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c0</span>.<span style=color:#a6e22e>_getRed</span>() <span style=color:#75715e>// color 0 red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c0</span>.<span style=color:#a6e22e>_getGreen</span>() <span style=color:#75715e>// color 0 green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c0</span>.<span style=color:#a6e22e>_getBlue</span>() <span style=color:#75715e>// color 0 blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_getRed</span>() <span style=color:#75715e>// color 1 red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_getGreen</span>() <span style=color:#75715e>// color 1 green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>c1</span>.<span style=color:#a6e22e>_getBlue</span>() <span style=color:#75715e>// color 1 blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>n</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// denominator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>n0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>i</span>; <span style=color:#75715e>// color 0 numerator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>n1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span>; <span style=color:#75715e>// color 1 numerator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>n0</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>d</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>n1</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>d</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scaled_r0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>r0</span>; <span style=color:#75715e>// scaled red 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_g0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>g0</span>; <span style=color:#75715e>// scaled green 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_b0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_0</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>b0</span>; <span style=color:#75715e>// scaled blue 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scaled_r1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>r1</span>; <span style=color:#75715e>// scaled red 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_g1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>g1</span>; <span style=color:#75715e>// scaled green 0 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>scaled_b1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ratio_1</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>b1</span>; <span style=color:#75715e>// scaled blue 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>interpolated_r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scaled_r0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>scaled_r1</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>interpolated_g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scaled_g0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>scaled_g1</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>interpolated_b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scaled_b0</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>scaled_b1</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>interpolated_r</span>, <span style=color:#a6e22e>interpolated_g</span>, <span style=color:#a6e22e>interpolated_b</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>colors</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Auxiliary Functions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>ENTER</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>antialiasing</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>false</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>antialiasing</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>ENTER</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>antialiasing</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>true</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>antialiasing</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>BACKSPACE</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>lines</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>false</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lines</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>             
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyCode</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>BACKSPACE</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>lines</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>true</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lines</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>             
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>yA</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>yB</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>yC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>19</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>randomint</span>(<span style=color:#a6e22e>min</span>, <span style=color:#a6e22e>max</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>min</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>ceil</span>(<span style=color:#a6e22e>min</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>max</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>); <span style=color:#75715e>// The maximum is inclusive and the minimum is inclusive
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div></div></details></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/anfbalceroce/VisualComputing/commit/524c008a048076f949d9bfe2df6d07e5350a7ced title='Last modified by anfbalceroce | October 19, 2022' target=_blank rel=noopener><img src=/VisualComputing/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 19, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#workshop-02---optional-exercises>Workshop 02 - Optional Exercises</a><ul><li><ul><li><a href=#exercise>Exercise</a></li></ul></li><li><a href=#primitive-rasterization--color-shading>Primitive Rasterization + Color Shading</a><ul><li><a href=#implementation-details>Implementation Details</a></li></ul></li><li><a href=#z-buffer>Z-buffer</a><ul><li><a href=#implementation-details-1>Implementation Details</a></li></ul></li><li><a href=#texture-mapping>Texture Mapping</a><ul><li><a href=#implementation-details-2>Implementation Details</a></li></ul></li><li><a href=#generalized-texture-mapping>Generalized Texture Mapping</a><ul><li><a href=#implementation-details-3>Implementation Details</a></li><li><a href=#some-examples>Some Examples</a></li></ul></li><li><a href=#anti-aliasing>Anti-aliasing</a><ul><li><a href=#implementation-details-4>Implementation Details</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>